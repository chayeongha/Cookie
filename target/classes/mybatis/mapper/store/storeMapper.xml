<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  
  <mapper namespace="com.cookie.basic.store.StoreMapper">
  	<insert id="storeInsert" parameterType="StoreVO" useGeneratedKeys="true" keyProperty="sNum">
  			insert into store values(0,#{sName},#{sTel},#{roadFullAddr},#{sNotice},0,#{memNum},#{memId})
  	</insert>
  	
  	<update id="storeUpdate" parameterType="StoreVO">
  		update store set sName=#{sName}, sTel=#{sTel}, roadFullAddr=#{roadFullAddr} where sNum=#{sNum}
  	</update>
  	
  	<select id="sNumSearch" parameterType="StoreVO" resultType="StoreVO">
  		select * from store where sName=#{sName}
  	</select>
  	  	
  	<select id="info" parameterType="StoreVO" resultType="StoreVO">
  		select * from store where sNum=#{sNum}
  	</select>
  	
  	
  	<resultMap type="StoreVO" id="storeResult">
  		<id column="sNum" property="sNum"/>
  		<result column="sName" property="sName"/>
  		<result column="sTel" property="sTel"/>
  		<result column="roadFullAddr" property="roadFullAddr"/>
  		<result column="sNotice" property="sNotice"/>
  		<result column="sOn" property="sOn"/>
  		<result column="memNum" property="memNum"/>
  		<result column="memId" property="memId"/>
  		<association property="storeFilesVO" javaType="StoreFilesVO">
  			<id column="fNum" property="fNum"/>
  			<result column="fName" property="fName"/>
  			<result column="oName" property="oName"/>  		
  		</association>
  	</resultMap>
  	
 
  	<select id="searchInfo" parameterType="StoreVO" resultMap="storeResult">
  		select * from store S left outer join storeFiles F 
  		on S.sNum = F.sNum  		
  		where S.memNum=#{memNum}
  	</select>
  	
  	<update id="onUpdate" parameterType="StoreVO">
  		update store set sOn=1 where sNum=#{sNum}  	
  	</update>
  	
  	<update id="offUpdate" parameterType="StoreVO">
  		update store set sOn=0 where sNum=#{sNum}
  	</update>
  	
  	
  	<select id="checkStore" parameterType="StoreVO" resultType="Integer">
		select count(*) from store where sName=#{sName}  	
  	</select>
  	

  	
  </mapper>
  
  
